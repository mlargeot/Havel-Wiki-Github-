# Challenge Metadata

## Summary

- [1. Purpose of the Feature](#1.-purpose-of-the-feature)
- [2. Functional Description](#2.-functional-description)
- [3. User Roles and Permissions](#3.-user-roles-and-permissions)
- [4. Challenge Metadata Fields](#4.-challenge-metadata-fields)
- [5. Functional Rules](#5.-functional-rules)
	- [5.1 Event-Scoped Existence](#5.1-event-scoped-existence)
	- [5.2 Creation Rules](#5.2-creation-rules)
	- [5.3 Editing Rules](#5.3-editing-rules)
	- [5.4 Validation Rules](#5.4-validation-rules)
	- [5.5 Deletion Rules](#5.5-deletion-rules)
- [6. User Interface Requirements](#6.-user-interface-requirements)
	- [6.1 Challenge List (Event-Level)](#6.1-challenge-list-(event-level))
	- [6.2 Creation/Edition Form](#6.2-creation/edition-form)
	- [6.3 Version History](#6.3-version-history)
- [7. Error Handling](#7.-error-handling)
- [8. Dependencies and Interactions](#8.-dependencies-and-interactions)
- [9. Success Criteria](#9.-success-criteria)

## 1. Purpose of the Feature

The **Challenge Metadata module** enables administrators and challenge creators to **define and manage challenges strictly within the context of a specific event**.  
Challenges do not exist globally — they live inside one event and cannot be accessed, displayed, or reused outside that event.

This ensures event isolation and simplifies administration.

## 2. Functional Description

Within an event, authorized users can:

- Create new challenges.
- Edit existing challenges.
- Organize challenges into categories.
- Configure scoring, flags, hints, and deployment parameters.
- Control the visibility of challenges within the event.

All challenge metadata is stored **within the event** and follows the event lifecycle.  
If an event is archived or deleted, its challenges disappear with it.

## 3. User Roles and Permissions

|Role|Permissions|
|---|---|
|**Administrator**|Full control over all challenges in the event (create/edit/delete/archive).|
|**Challenge Creator**|Can create and edit challenges _only inside the event they have access to_.|
|**Event Organizer**|Can adjust challenge settings tied to event rules (points, visibility, release timing).|
|**Participant**|Cannot see metadata; only interacts with deployed/active challenges.|

## 4. Challenge Metadata Fields

| Field                     | Description                                                     | Type        | Required                       | Notes                                                                                                                                                                                         |
| ------------------------- | --------------------------------------------------------------- | ----------- | ------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **ID**                    | Unique challenge identifier inside the event.                   | System      | Yes                            | Not globally unique.                                                                                                                                                                          |
| **Title**                 | Name of the challenge (unique within the event).                | Text        | Yes                            | Required for filtering and display.                                                                                                                                                           |
| **Category**              | Challenge domain (Web, Crypto, Pwn, etc.).                      | Enum        | No                             | Event-specific grouping.                                                                                                                                                                      |
| **Difficulty**            | Difficulty classification.                                      | Enum        | No                             | Easy / Medium / Hard / Expert.                                                                                                                                                                |
| **Author**                | User who created the challenge.                                 | System      | Yes                            | Auto-linked to creator profile.                                                                                                                                                               |
| **Description**           | Problem description and context.                                | Text        | Yes                            | Displayed to players.                                                                                                                                                                         |
| **Flag Format**           | Expected flag structure (e.g. `HAVEL{}` format).                | Text        | No                             | Used for validation and UI hints.                                                                                                                                                             |
| **Scoring Type**          | Static, dynamic or blood scoring                                | Enum        | Yes                            | **Dynamic** = available points decrease each solve (**min points** > score / 2 points & **decrease** > % of score set by the admin (max 50%))<br>**Blood** = Bonus point for first solve only |
| **Points**                | Starting score.                                                 | Integer     | Yes                            | Required for scoreboard.                                                                                                                                                                      |
| **Deployment Type**       | Q&A, Container, VM, or Network challenge.                       | Enum        | Yes                            | Determines orchestration workflow.                                                                                                                                                            |
| **Deployment Parameters** | Parameters needed to deploy the environment.                    | Var.        | Yes (for VM/Container/Network) | Stored event-locally.                                                                                                                                                                         |
| **Challenge Files**       | Files distributed to participants (scripts, binaries, images…). | Upload      | Optional                       | Stored inside event storage.                                                                                                                                                                  |
| **Hints**                 | Optional clues with optional penalties.                         | List        | Optional                       | Configurable in UI.                                                                                                                                                                           |
| **Visibility**            | Hidden / Visible.                                               | Enum        | Yes                            | Controls when participants can access it.                                                                                                                                                     |
| **Release Conditions**    | Optional unlock rules (time, dependencies).                     | Conditional | Optional                       | Future version (v0.8+).                                                                                                                                                                       |
| **Version History**       | Tracks edits within the event.                                  | System      | Yes                            | Supports rollback.                                                                                                                                                                            |
| **Last Updated**          | Timestamp of last modification.                                 | System      | Yes                            | Auto-generated.                                                                                                                                                                               |

## 5. Functional Rules

### 5.1 Event-Scoped Existence

- A challenge **belongs only to the event where it was created**.
- It is **not visible** outside that event.
- It cannot be > moved, > shared, or > referenced in another event without duplication (future import/export).

### 5.2 Creation Rules

1. User must be inside an event admin area.
2. Challenge is created in _draft_ state.
3. Mandatory metadata fields must be completed.
4. Title must be unique **within the event**.
5. Deployment type determines additional required fields.

### 5.3 Editing Rules

- Only authorized users (Admin, Creator) can edit.
- Version history is automatically created.
- Changes only affect the event’s instance of the challenge.

### 5.4 Validation Rules

A challenge cannot be activated or made visible unless:

- All required metadata is defined.
- Deployment parameters are valid.

### 5.5 Deletion Rules

- Deleting a challenge removes it **only from the event**.
- There is no global impact.
- Deletion must fail if the event is active and challenge has deployed instances, instances must be shutdown by the event admin which will notify the users (v0.8 safety rule).

## 6. User Interface Requirements

### 6.1 Challenge List (Event-Level)

- Accessible via **Event → Challenges**.
- Displays all challenges belonging to the event.
- Filters by category, difficulty, status, visibility.
- Buttons: Create / Edit / Duplicate (future) / Delete / Archive.

### 6.2 Creation/Edition Form

**Sections**:
- General Information
- Scoring & Flags
- Deployment Settings
- Files
- Hints
- Preview

Real-time validation and autosave recommended.

### 6.3 Version History

- Chronological list of changes
- “Restore version” option

## 7. Error Handling

| Error                              | Behavior                        |
| ---------------------------------- | ------------------------------- |
| Missing required metadata          | Block save; show inline error.  |
| Duplicate name inside event        | Block creation; suggest rename. |
| Invalid deployment parameters      | Prevent activation.             |
| Unauthorized access to edit        | Deny with error + log entry.    |
| Challenge visible while incomplete | UI must prevent “Draft” state.  |

## 8. Dependencies and Interactions

|Module|Relationship|
|---|---|
|**Event Management**|Challenge metadata cannot exist without an event.|
|**Challenge Types**|Determines required metadata fields and validation rules.|
|**Scoreboard**|Uses title, points, and scoring type.|
|**Deployment System**|Reads deploymentType + parameters to start environments.|

## 9. Success Criteria

|Criterion|Expected Outcome|
|---|---|
|**All metadata defined**|Complete and validated challenge data.|
|**Event-scoped isolation**|Challenge accessible only inside its event.|
|**Usability**|Challenge creation < 2–3 min average.|
|**Versioning**|Full history traceable and restorable.|
